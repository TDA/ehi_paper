\section{Lessons Learned}
    From our results, it is evident that the vulnerability exists in the wild. Despite its relatively low occurrence rate compared to the more popular SQL Injection and XSS (Cross-Site Scripting), when we take the total number of websites on the World Wide Web --- 1,018,863,952 according to Internet Live Stats \cite{InternetLiveStats2016} as of early 2016 --- and calculate \successDelta\ percent (the occurrence rate of E-Mail Header Injection vulnerability as found by our system) of that number, we end up with 11,309,390 websites - a pretty significant number. We agree that an extrapolation of that kind might not be an accurate measure of the prevalence of the vulnerability. However, even with as few as a thousand websites affected by this vulnerability, it can still have a disastrous impact on these websites, and also on overall World Wide Web due to the traffic caused by the sheer number of generated e-mails. 
    
    After analyzing the results, we would like to make a few more observations. We believe that one of the reasons for the small percentage of occurrence (compared to SQL Injection or XSS), can be attributed to what we like to call the `car parking analogy'.
    The car parking analogy is something like this: Imagine that we are parking a car on a road that is prone to attacks by thieves. Now, if all the cars were unlocked, the car that is most likely to get stolen is quite unsurprisingly the most expensive one or the one that is easiest to get away with.
    
    Now imagine the same thing on the World Wide Web: we have websites that can each have multiple vulnerabilities. Now, it makes sense for an attacker to try and attack websites with more widespread vulnerabilities such as SQL Injection or XSS, rather than attempt to exploit E-Mail Header Injection, seeing as this requires a more concentrated effort, with carefully crafted payloads and a waiting time for the e-mail to be delivered. SQL Injection attacks and XSS attacks are also better documented, with well-known attack vectors, and automated tools to help detect the presence of these vulnerabilities on websites.
    
    This also gives more incentive for the website developer to add protection against attacks such as SQL injection and XSS. The developer might then (possibly with the help of a sanitization library) sanitize the user input and remove \emph{all} special characters, including the newline characters (\textbackslash{}n, \textbackslash{}r), which adversely affects E-Mail Header Injection attacks.

	We come to this conclusion because of our discovery of the \dq{\texttt{To header injection}}. Clearly, this is possible due to incomplete sanitization performed by the application. We suspect that this incomplete sanitization is actually sanitization that is performed for some other vulnerability, and not specifically for E-Mail Header Injection attacks. We would also like to remark that \dq{\texttt{To header injection}} is not complete E-Mail Header Injection, but only a special subset.
	
    Thus, indirectly, this kind of protection against other attacks affects the attempts to perform E-Mail Header Injection. However, this does not completely negate the attempts if the checks are only on the client-side. Also, even with server-side validation, often, the only input fields that are validated are ones that are either inserted into the database (SQL Injection) and the ones that are displayed to the user as part of the web site (XSS).

	A second and a far more common reason for our fuzzing attempts to fail is the bot-blocking mechanisms built into the websites. CAPTCHAs (as explained in Section \ref{issues:captcha} and in the following section) pose a very difficult problem for our system to exploit E-Mail Header Injection, even if it is present.

	This does not mean that the vulnerability is not a large threat. In fact, this vulnerability can also have some major consequences, the least of which can be spamming and phishing attacks.
	In today's digital world, identity theft has become all the more common. E-Mail Header Injection provides attackers with the ability to easily extract information about users, not just from a server, but from the user himself, by sending him fake messages that look extremely authentic, since these messages are sent by the mail server of the website itself.
    
    From our research, we found two different forms of the E-Mail Header Injection Vulnerability: the first one is the traditional one, where we are able to inject any header into the forms, allowing us complete control over the contents of the e-mail. We identify this with the presence of both the \dq{\texttt{bcc}} header and the \dq{\texttt{x-check}} header. This is the most potent form of the vulnerability and is found on quite a few websites. This is also the vulnerability that is documented and discussed on many websites.
    
    The second attack is an interesting one, as this has not yet been documented, and provides the ability to inject multiple e-mail addresses into only the \dq{\texttt{To}} field. We christened this as \dq{\texttt{To header injection}}. In this form of the vulnerability, we are able to simply add addresses to the \dq{\texttt{To}} field of the form with newlines separating the e-mail addresses. Whether this particular form of the vulnerability is found due to the websites in question, or whether this is an implementation issue with a particular language or framework, is unclear. However, from our preliminary analysis, it is evident that these websites do not share much with respect to the languages and frameworks used. 
    Even in this form of the attack, we are still able to extract information that should be private to a given user, and in some of these cases, able to inject enough data to spoof the first few lines of the e-mail message. From Table~\ref{tab:analysis}, information leakage using \dq{\texttt{To header injection}} was possible on 142 forms, while spoofing using \dq{\texttt{To header injection}} was possible on 11 forms.
    
    While not being as impactful as the primary vulnerability, this second form of the vulnerability does still provide the ability to send e-mails to multiple recipients, and can easily result in information leakage or spam generation on a large scale.
    
