\section{Related Work}

% Adam: Sai, can you combine all the \cites at the same line like I did for the others? 
There are different approaches to finding vulnerabilities in web applications, and most approaches use either Black-Box testing or White-Box testing.
Our work is based on the black-box testing approach to finding vulnerabilities on websites, and research has made use of this methodology to find vulnerabilities in web applications~\cite{Beizer:1995:BTT:202699, Huang, kals2006secubat, payet13:ears-in-the-wild, zanero2005automatic}. There has been significant discussion on both the benefits of such an approach~\cite{black-box} and its shortcomings~\cite{Doupe2012, Doupe2010}.

Our work does not intend to act as a vulnerability scanner, but as a means to identify an \ehi vulnerability in a given web application. In this sense, because we are injecting payloads into the web application, our work is related to other injection based attacks, such as SQL Injection~\cite{sql1, sql0, sql2}, Cross-Site Scripting \cite{Injection1, KleinAmit}, HTTP Header Injection~\cite{sessionride}, and the related Simple Mail Transfer Protocol (SMTP) Injection~\cite{Terada2015}.

The attack described by Terada~\cite{Terada2015} is one that attacks the underlying SMTP mail servers by injecting SMTP commands (which are closely related to E-Mail Headers and usually have a one-to-one mapping, e.g., \texttt{To} e-mail header has a corresponding \texttt{To} SMTP header) to exploit the SMTP server's pipelining mechanism. Terada also describes proof-of-concept attacks against certain mailing libraries such as \texttt{Ruby Mail} and \texttt{JavaMail}. This attack, although trying to achieve a similar result, is distinctly different from ours. Terada's paper also makes this observation and discusses why it is different from \ehi.

In comparison, our work tries to exploit application-level flaws in user input sanitization, which allow this attack. Our work does not intend to exploit the pipelining mechanism, but to exploit the implementation of the mail function in most popular programming languages, which leaves them with no way to distinguish between user supplied headers and headers that are legitimately added by the application.

Although \ehi vulnerabilities have been present for over a decade, there has not been much written about it in the literature, and we find only a few articles on the Internet describing the attack.

The first documented article dates to over a decade ago; a late 2004 article on phpsecure.info~\cite{Tobozo} accredited to user \lstinline|tobozo| describing how this vulnerability existed in the reference implementation of the mail function in PHP, and how it can be exploited. Following this, we found other blog posts~\cite{Calin, DK, Injection2, Nicol, Pope}, each describing how to exploit the vulnerability by using newlines to camouflage headers inside user input. A wiki entry~\cite{Injection} also describes the ways to prevent such an attack. However, none of these articles have performed these attacks against real-life websites.

Another blog post written by user \lstinline|Voxel@Night|~\cite{Tendencies2014}, recounts an actual attack against a WordPress plugin, \texttt{Contact Form}, with a proof of concept\footnotemark. It also showcases the vulnerable code in the plugin that causes the vulnerability. However, this article targets just one plugin and does not aim to find the prevalence of said plugin usage. Neither does it inform the creators of the plugin to fix the discovered vulnerability. Note that this plugin is used actively on 300,000 websites (according to~\cite{BestWebSoft2016}), but is yet to be fixed.
\ehi vulnerability was described briefly by Stuttard and Pinto in their book, ``\emph{The Web Application Hacker's Handbook}''~\cite{stuttard2011web}. The book, however, does not go into detail on either the attack or the ways to mitigate such an attack. Our work, on the other hand discusses the means to mitigate the attack. We also describe, in detail, the payloads that can be used and the need for varying the payloads (Section~\ref{Comp:Fuzzer}).

To the best of our knowledge, no other research has been conducted to determine the prevalence of this vulnerability on the World Wide Web. We have managed to, on a large scale, crawl and inject web applications with comparatively benign payloads (the \texttt{bcc} header) to identify the existence of this vulnerability without causing any ostensible harm to the website. Our injected payloads \emph{do not contain any special characters other than the newline character} and thus can't cause any unintended consequences. Also, as we are only injecting the \texttt{bcc} header, the underlying mail servers should not be affected by the additional load. Our work serves to not only prove the existence of the vulnerability on the World Wide Web but to quantify its prevalence.
